	<!-- Main jumbotron for a primary marketing message or call to action -->
	<div class="jumbotron">
		<div class="container">
			<h2><a href="http://en.wikipedia.org/wiki/Session_hijacking" target='_blank' title="Session Hijacking on Wikipedia"> Session Hijacking </a></h2>
			<p>
				Occurs when a hacker intercepts or otherwise obtains a session cookie from another user.
			</p>
			<p>
				Hijack a session on this site yourself...
			</p>
		</div>
	</div>
	
	<div class="container">
		<div class="panel-group" id="accordion">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Cookies and Sessions</a></h3>
				</div>
				<div id="collapseOne" class="panel-collapse collapse in">
					<div class="panel-body">
						<p>
							A <strong>cookie</strong> is a small piece of data sent by a website and stored on your computer by your browser - yes, any website is allowed to store data on your computer if you have cookies enabled!
							<br>
							Whenever you make a request to the website, your browser sends the cookies back so the website can "remember" who you are.
						</p>
						<ul>
							<li>
								You can see the cookies stored by various websites.  For example, in <a href="https://support.mozilla.org/en-US/kb/cookies-information-websites-store-on-your-computer">Firefox</a>:  Tools... Web Developer.. Storage Inspector
							</li>
							<li>
							For more info, see: <a href="http://en.wikipedia.org/wiki/HTTP_cookie" title="HTTP Cookies on Wikipedia">HTTP Cookies on Wikipedia</a>.
							</li>
						</ul>
							
						<p>
							A <strong>session</strong> is a technique used by a website to maintain state information about a specific user.
							<br>
							Sites need sessions because HTTP is <strong>stateless</strong>.   Session information is usually stored on the server and identified by a unique "key" sent in a cookie.
							So, when you log in to this site, for example, it starts a "session" with a unique key stored in a "session cookie" that identifies you every time you subsequently request a page.
							<br>
							For more info, see <a href="http://en.wikipedia.org/wiki/Session_(computer_science)" title="Sessions on Wikipedia">About Sessions on Wikipedia</a>
						</p>
						<p>
							You can <strong>manipulate</strong> the cookies on your computer using a variety of simple tools.
						    <br />
						    A very easy approach is to use the Firefox Addon <a href="https://addons.mozilla.org/en-US/firefox/addon/cookies-manager-plus/">Cookies Manager</a> <br />
						    This addon allows you to view an edit your cookies. Why? Well, to take over someone else's account, of course!
						</p>
					</div>
				</div>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">Be an Imposter!</a></h3>
				</div>
				<div id="collapseTwo" class="panel-collapse collapse">
					<div class="panel-body">
						<p>
							To create a simple demonstration of session hijacking, this site exposes a vulnerability that allows a hacker to "masquerade" as any user!
						</p>
						<p>
							Here's how it works:
						</p>
						<ol>
							<li>
								This site has an option (for demonstration purposes) to use a conceptually tempting, simple approach to maintaining a session:
								<ul>
								  <li> the DB id of the logged in user is stored in their cookie.</li>
								  <li> when the user makes a request, their "userid" cookie is used to maintain their login session. </li>
								</ul>
							</li>
							<li><a href="<?php echo rewriteURL(SESSION_HIJACK); echo urlParam('session_logic=userid'); ?>">Click here to activate this simple session handling approach, using the "userid" cookie.</a></li>
							<li>
								Log in to U-Hack-It and then look for a cookie from this site called <strong>"userid"</strong> - this cookie contains the DB key for your user record in the site's DB!<br />
								This uniquely identifies YOU when this cookie is sent back to the site on subsequent requests.
							</li>
							<li>
								But once a hacker "guesses" this is how the site works, they can "hijack" any user's account by simply changing the contents of this cookie to be the id of any other user!
							</li>
							<li>
								To learn more, look at the Session handling code in class-user.php
							</li>
						</ol>
						<h4>Exercise</h4>
						<p>
							You can masquerade as any user on the site by <a href="<?php echo rewriteURL(SESSION_HIJACK); echo urlParam('session_logic=userid'); ?>">enabling its "userid" session handling logic</a>.
							<br />
							<strong>Try it</strong> - can you guess some of the other user ID's, edit your userid cookie, and become an imposter?
						</p>
					</div>
				</div>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseThree">Hijack a Session... for real!</a></h3>
				</div>
				<div id="collapseThree" class="panel-collapse collapse">
					<div class="panel-body">
						<p>
							Better session handling uses a complex, random "key" to identify your session - one that would be very hard to guess.
							Nonetheless, if a hacker gets ahold of your session "key", they can masquerade as you just as you did above!
						</p>
						<p>
							Here's how it works:
						</p>
						<ol>
							<li>
								First, you need to get ahold of some other user's session key.
								<br />
								Hackers have devised a number of <a href="http://en.wikipedia.org/wiki/Session_hijacking#Methods">methods for acquiring session keys</a>.
							</li>
							<li>
								A simple way to obtain someone's session key is to simply access their computer - if you can sneak a peak at their session cookie, that's all you need.
								<br />
								<small>We examine a more sophisticated method for obtaining session keys in the XSS exploit.</small>
							</li>
							<li>
								Have a friend log into the same instance of U-Hack-It, or just use a differnt browser on your comptuer to create a different user account.
							</li>
							<li>
								Look for the U-Hack-It PHPSESSID cookie - it contains the secret session key you need to take over that other user's session.
							</li>
							<li>
								Make note of the PHPSESSID cookie contents, edit your own PHPSESSID cookie to match, reload the page 
								and voila - you have hijacked the session!
								<br /><small><a href="<?php echo rewriteURL(SESSION_HIJACK); echo urlParam('session_logic=session_key'); ?>">Ensure userid session handling is off</a></small> 

							</li>
							</li>
						</ol>
						<h4>Try it Yourself!</h4>
						<p>
							Can you can hijack a session using the method above?
							<br />
							First - you will need <a href="<?php echo rewriteURL(SESSION_HIJACK); echo urlParam('session_logic=session_key'); ?>">disable the simplistic userid session handling</a> 
 							so the site goes back to using standard, "secure" session handling.
							<br />
							<strong>Try it</strong> - acquire a session key, edit your PHPSESSID cookie, and hijack a session!
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>