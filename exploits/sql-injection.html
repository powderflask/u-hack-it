	  
	    <!-- Main jumbotron for a primary marketing message or call to action -->
	<div class="jumbotron">
	    <div class="container">
	        <h2>
				<a href="http://en.wikipedia.org/wiki/SQL_injection" target='_blank' title="SQL Injection on Wikipedia">
					SQL Injection Attacks
				</a>
			</h2>
	        <p>Caused when raw, unfiltered data entered by a user is used in an SQL query.</p>
	        <p>Use an SQL Injection to hack this site's login form yourself...</p>
	    </div>
	</div>
	
	<div class="container">
		<div class="panel-group" id="accordion">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Authentication By-pass</a></h3>
				</div>
				<div id="collapseOne" class="panel-collapse collapse in">
					<div class="panel-body">
						<div class="panel panel-default medium pull-right">
							<div class="panel-body">
			                    <form class="form-horizontal" action="<?php echo rewriteURL(LOGIN);  echo urlParam('auth_querylogic=1'); ?>" method="post">
			                        <div class="form-group">
			                            <input name="username" type="text" placeholder="Email" class="form-control">
			                        </div>
			                        <div class="form-group">
			                            <input name="password" type="password" placeholder="Password" class="form-control">
			                        </div>
			                        <button type="submit" class="btn btn-success">
			                            Sign in
			                        </button>

			                    </form>
							</div>
						</div>
						<p>Use of unfiltered user input in the login script creates a vulnerability that allows a hacker to login to the site without having an account!</p>
						<p>Here's how it works:</p>
						<ol>
							<li>Use the "Sign In" form to the right, which exposes this exploit.</li>
							<li>Start by logging in with your own username and password (register first if you don't have one yet).<br />
								Carefully examine the SQL query generated by your login attempt (shown at top of page).
						    </li>
							<li>Logout, and now, instead of your real username and password, enter:
								<ul>
									<li><<strong>hacker' OR 'a'='a</strong></li>
								</ul>
								in both fielss.  Be sure to enter it <em>exactly</em> as shown, with the mis-matched quotation marks.
							</li>
							<li>Press "Sign In" and Voila! You are logged into the site under someone elses account!</li>
							<li>How did that happen?  Examine the "Authentication query" revealed during login.<br />
								What we did here was to "inject" a fragment of SQL code into the query to change its meaning.<br />
								In so doing, we fooled the software into believing the authentication was successful.
							</li>
							<li>You'll notice this hack only works on this page.  The other pages use a harder to crack (although still insecure) authentication script.<br />
								To learn more, look at the code in class-user.php::authenticate()</li>
						</ol>
						<h4>Try it yourself!</h4>
						<p>See if you can derive a different "SQL injection" string that also by-passes authentication.<br />
							<small>Hint: press the "Sign In" button with an empty form to see the basic layout of the query - 
								   what text can be added to the "username" value to create a query that returns valid results?
							</small>
						</p>
						<div>
							<button type="button" class="btn btn-small btn-info" data-toggle="collapse" data-target="#solution">
								don't peak!
							</button>
							<div id="solution" class="collapse">
								Here's one that makes the password check completely redundant - can you see how it works?<br />
								<ul>
									<li><em>Email:</em> <strong>hacker' OR 1=1 OR 'a'='a</strong></li>
								</ul>
								Here's one that allows you to take over ANY account by switching up the user's id...<br />
								<ul>
									<li><em>Email:</em> <strong>hacker' OR ('a'='a</strong></li>
									<li><em>Password:</em> <strong>hacker' OR 'a'='a') and id='6</strong></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">Making Things a Little Trickier...</a></h3>
				</div>
				<div id="collapseTwo" class="panel-collapse collapse">
					<div class="panel-body">
						<div class="panel panel-default medium pull-right">
							<div class="panel-body">
			                    <form class="form-horizontal" action="<?php echo rewriteURL(LOGIN);  echo urlParam('auth_applogic=1'); ?>" method="post">
			                        <div class="form-group">
			                            <input name="username" type="text" placeholder="Email" class="form-control">
			                        </div>
			                        <div class="form-group">
			                            <input name="password" type="password" placeholder="Password" class="form-control">
			                        </div>
			                        <button type="submit" class="btn btn-success">
			                            Sign in
			                        </button>

			                    </form>
							</div>
						</div>
						<p>The attack above works because the password is "checked" in the SQL query itself - if we can trick the query into ignoring the password, we're in.</p>
						<p>Like most programmers, the login form to the right performs an explicit password check - <strong>Try It!</strong>: the hack above won't work on this form.
							But that still won't stop a determined hacker ...</p>
						<p>Here's how it works:</p>
						<ol>
							<li>the hacker will actually inject a fake record into the query, with a fake username and password.</li>
							<li>To do this, the hacker needs to understand the structure of the DB table so they can get the SQL right, but that's not usually too hard to figure out.</li>
							<li>Once we have figured out the correct injection code for the user name field, we simply enter the fake password, and voila - we're in.</li>
						</ol>
						<h4>Exercise</h4>
						<p>See if you can create an "SQL injection" that by-passes authentication on the form to the right.<br />
							<small>Hint: the user DB table has 4 columns: id, username, password, personalInfo</small><br />
							<small>2nd Hint: the UNION command in SQL combines the results of two SELECT queries.</small> 
						</p>
						<div>
							<button type="button" class="btn btn-small" data-toggle="collapse" data-target="#solution2">
								don't peak!
							</button>
							<div id="solution2" class="collapse">
								This injection code UNION's the programmed query with a fake DB record containing its own password - can you see how it works?<br />
								<ul>
									<li><em>Email:</em> <strong>' UNION SELECT '2','hacker','abc','</strong></li>
									<li><em>Password:</em> <strong>abc</strong></li>
								</ul>
								<p>Notice that by changing the ID number in the injected SELECT, we can use this injection to login as any user on the system!</p>
								<p>Note: this attack will not work on this page - try it on any other page (which all use the explicit password check authentication script).</p>	
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
